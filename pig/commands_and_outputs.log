Script started on Wed 07 Oct 2015 06:42:27 PM EDT
]0;ajr619@login-1-1:~/pig[?1034h[ajr619@login-1-1 pig]$ cat [K[K[K[Kcat wordcount.pig 
patterns = LOAD 'words' AS (pat:chararray);
in = LOAD 'input';


Tokens = FOREACH in GENERATE TOKENIZE((chararray)$0) as word;
Tokens = FOREACH Tokens GENERATE FLATTEN(word) as word;
Tokens = FOREACH Tokens GENERATE FLATTEN(REGEX_EXTRACT_ALL(LOWER(word),'.*?([a-z]+).*?')) AS word;

inter_res = JOIN patterns BY pat LEFT, Tokens BY $0 ;

temp1  = GROUP inter_res BY patterns::pat;

actual_result  = FOREACH temp1 GENERATE $0, COUNT($1.Tokens::word);

DUMP actual_result;
]0;ajr619@login-1-1:~/pig[ajr619@login-1-1 pig]$ cat input 
9-Dec-14,5:00PM,.#Hackatopia,Tribeca Film Hackathon: Code As A New Language For Content Creators
28-Oct-14,7:00PM,.#NYCHadoop,Hadoop-NYC Strata/Hadoop World Meetup at AppNexus NYC
31-Dec-14,3:00PM,.#Hackatopia,Designers, Developers, Doers, don't miss this upcoming Chicago hackathon
]0;ajr619@login-1-1:~/pig[ajr619@login-1-1 pig]$ cat pattee[K[K[K[K[K[K[K[K[K[K
]0;ajr619@login-1-1:~/pig[ajr619@login-1-1 pig]$ 
]0;ajr619@login-1-1:~/pig[ajr619@login-1-1 pig]$ 
]0;ajr619@login-1-1:~/pig[ajr619@login-1-1 pig]$ 
]0;ajr619@login-1-1:~/pig[ajr619@login-1-1 pig]$ cat i[Kpatter[K[K[K[K[K[K[K[K[K[Kcat 
input                  pig_1444257606301.log  pig_1444257626462.log  pig_1444257647388.log  typescript             wordcount.pig          words
[ajr619@login-1-1 pig]$ cat word
wordcount.pig  words          
[ajr619@login-1-1 pig]$ cat words 
hackathon
dec
chicago
java
]0;ajr619@login-1-1:~/pig[ajr619@login-1-1 pig]$ pig wordcount.pig 
log4j:WARN No appenders could be found for logger (org.apache.hadoop.util.Shell).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2015-10-07 18:42:55,471 [main] INFO  org.apache.pig.Main - Apache Pig version 0.12.0-cdh5.4.5 (rexported) compiled Aug 12 2015, 14:17:24
2015-10-07 18:42:55,471 [main] INFO  org.apache.pig.Main - Logging error messages to: /home/ajr619/pig/pig_1444257775457.log
2015-10-07 18:42:55,900 [main] INFO  org.apache.pig.impl.util.Utils - Default bootup file /home/ajr619/.pigbootup not found
2015-10-07 18:42:56,007 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - mapred.job.tracker is deprecated. Instead, use mapreduce.jobtracker.address
2015-10-07 18:42:56,007 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:56,007 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine - Connecting to hadoop file system at: hdfs://babar.es.its.nyu.edu:8020
2015-10-07 18:42:56,463 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:56,489 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:56,509 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:56,529 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:56,549 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:56,568 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:56,586 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:56,604 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:42:57,083 [main] WARN  org.apache.pig.PigServer - Encountered Warning IMPLICIT_CAST_TO_CHARARRAY 1 time(s).
2015-10-07 18:42:57,086 [main] INFO  org.apache.pig.tools.pigstats.ScriptState - Pig features used in the script: HASH_JOIN,GROUP_BY
2015-10-07 18:42:57,113 [main] INFO  org.apache.pig.newplan.logical.optimizer.LogicalPlanOptimizer - {RULES_ENABLED=[AddForEach, ColumnMapKeyPrune, DuplicateForEachColumnRewrite, GroupByConstParallelSetter, ImplicitSplitInserter, LimitOptimizer, LoadTypeCastInserter, MergeFilter, MergeForEach, NewPartitionFilterOptimizer, PushDownForEachFlatten, PushUpFilter, SplitFilter, StreamTypeCastInserter], RULES_DISABLED=[FilterLogicExpressionSimplifier, PartitionFilterOptimizer]}
2015-10-07 18:42:57,183 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MRCompiler - File concatenation threshold: 100 optimistic? false
2015-10-07 18:42:57,194 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.CombinerOptimizer - Choosing to move algebraic foreach to combiner
2015-10-07 18:42:57,211 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer - MR plan size before optimization: 2
2015-10-07 18:42:57,211 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer - MR plan size after optimization: 2
2015-10-07 18:42:57,255 [main] INFO  org.apache.hadoop.yarn.client.RMProxy - Connecting to ResourceManager at babar.es.its.nyu.edu/128.122.215.50:8032
2015-10-07 18:42:57,389 [main] INFO  org.apache.pig.tools.pigstats.ScriptState - Pig script settings are added to the job
2015-10-07 18:42:57,446 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - mapred.job.reduce.markreset.buffer.percent is deprecated. Instead, use mapreduce.reduce.markreset.buffer.percent
2015-10-07 18:42:57,446 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - mapred.job.reduce.markreset.buffer.percent is not set, set to default 0.3
2015-10-07 18:42:57,446 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress
2015-10-07 18:42:57,448 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Reduce phase detected, estimating # of required reducers.
2015-10-07 18:42:57,448 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Using reducer estimator: org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.InputSizeReducerEstimator
2015-10-07 18:42:57,451 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.InputSizeReducerEstimator - BytesPerReducer=1000000000 maxReducers=999 totalInputFileSize=310
2015-10-07 18:42:57,451 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Setting Parallelism to 1
2015-10-07 18:42:57,451 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - mapred.reduce.tasks is deprecated. Instead, use mapreduce.job.reduces
2015-10-07 18:42:57,958 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - creating jar file Job8459300394133049583.jar
2015-10-07 18:43:01,050 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - jar file Job8459300394133049583.jar created
2015-10-07 18:43:01,050 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - mapred.jar is deprecated. Instead, use mapreduce.job.jar
2015-10-07 18:43:01,068 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Setting up single store job
2015-10-07 18:43:01,073 [main] INFO  org.apache.pig.data.SchemaTupleFrontend - Key [pig.schematuple] is false, will not generate code.
2015-10-07 18:43:01,073 [main] INFO  org.apache.pig.data.SchemaTupleFrontend - Starting process to move generated code to distributed cache
2015-10-07 18:43:01,073 [main] INFO  org.apache.pig.data.SchemaTupleFrontend - Setting key [pig.schematuple.classes] with classes to deserialize []
2015-10-07 18:43:01,126 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 1 map-reduce job(s) waiting for submission.
2015-10-07 18:43:01,127 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - mapred.job.tracker.http.address is deprecated. Instead, use mapreduce.jobtracker.http.address
2015-10-07 18:43:01,130 [JobControl] INFO  org.apache.hadoop.yarn.client.RMProxy - Connecting to ResourceManager at babar.es.its.nyu.edu/128.122.215.50:8032
2015-10-07 18:43:01,140 [JobControl] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:43:01,438 [JobControl] INFO  org.apache.hadoop.mapreduce.lib.input.FileInputFormat - Total input paths to process : 1
2015-10-07 18:43:01,438 [JobControl] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths to process : 1
2015-10-07 18:43:01,451 [JobControl] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths (combined) to process : 1
2015-10-07 18:43:01,453 [JobControl] INFO  org.apache.hadoop.mapreduce.lib.input.FileInputFormat - Total input paths to process : 1
2015-10-07 18:43:01,453 [JobControl] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths to process : 1
2015-10-07 18:43:01,454 [JobControl] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths (combined) to process : 1
2015-10-07 18:43:01,574 [JobControl] INFO  org.apache.hadoop.mapreduce.JobSubmitter - number of splits:2
2015-10-07 18:43:01,707 [JobControl] INFO  org.apache.hadoop.mapreduce.JobSubmitter - Submitting tokens for job: job_1444143925809_0111
2015-10-07 18:43:01,852 [JobControl] INFO  org.apache.hadoop.yarn.client.api.impl.YarnClientImpl - Submitted application application_1444143925809_0111
2015-10-07 18:43:01,876 [JobControl] INFO  org.apache.hadoop.mapreduce.Job - The url to track the job: http://babar.es.its.nyu.edu:8088/proxy/application_1444143925809_0111/
2015-10-07 18:43:01,877 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - HadoopJobId: job_1444143925809_0111
2015-10-07 18:43:01,877 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - Processing aliases Tokens,in,inter_res,patterns
2015-10-07 18:43:01,877 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - detailed locations: M: patterns[1,11],patterns[-1,-1],inter_res[9,12],in[2,5],Tokens[5,9],Tokens[6,9],Tokens[7,9],inter_res[9,12] C:  R: inter_res[9,12]
2015-10-07 18:43:01,899 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 0% complete
2015-10-07 18:43:09,208 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 25% complete
2015-10-07 18:43:14,356 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 50% complete
2015-10-07 18:43:17,057 [main] INFO  org.apache.pig.tools.pigstats.ScriptState - Pig script settings are added to the job
2015-10-07 18:43:17,075 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - mapred.job.reduce.markreset.buffer.percent is not set, set to default 0.3
2015-10-07 18:43:17,075 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Reduce phase detected, estimating # of required reducers.
2015-10-07 18:43:17,075 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Using reducer estimator: org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.InputSizeReducerEstimator
2015-10-07 18:43:17,082 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.InputSizeReducerEstimator - BytesPerReducer=1000000000 maxReducers=999 totalInputFileSize=124
2015-10-07 18:43:17,082 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Setting Parallelism to 1
2015-10-07 18:43:17,515 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - creating jar file Job2892747256569788333.jar
2015-10-07 18:43:20,430 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - jar file Job2892747256569788333.jar created
2015-10-07 18:43:20,440 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Setting up single store job
2015-10-07 18:43:20,440 [main] INFO  org.apache.pig.data.SchemaTupleFrontend - Key [pig.schematuple] is false, will not generate code.
2015-10-07 18:43:20,440 [main] INFO  org.apache.pig.data.SchemaTupleFrontend - Starting process to move generated code to distributed cache
2015-10-07 18:43:20,440 [main] INFO  org.apache.pig.data.SchemaTupleFrontend - Setting key [pig.schematuple.classes] with classes to deserialize []
2015-10-07 18:43:20,457 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 1 map-reduce job(s) waiting for submission.
2015-10-07 18:43:20,459 [JobControl] INFO  org.apache.hadoop.yarn.client.RMProxy - Connecting to ResourceManager at babar.es.its.nyu.edu/128.122.215.50:8032
2015-10-07 18:43:20,463 [JobControl] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:43:20,650 [JobControl] INFO  org.apache.hadoop.mapreduce.lib.input.FileInputFormat - Total input paths to process : 1
2015-10-07 18:43:20,650 [JobControl] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths to process : 1
2015-10-07 18:43:20,650 [JobControl] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths (combined) to process : 1
2015-10-07 18:43:20,847 [JobControl] INFO  org.apache.hadoop.mapreduce.JobSubmitter - number of splits:1
2015-10-07 18:43:20,940 [JobControl] INFO  org.apache.hadoop.mapreduce.JobSubmitter - Submitting tokens for job: job_1444143925809_0112
2015-10-07 18:43:20,964 [JobControl] INFO  org.apache.hadoop.yarn.client.api.impl.YarnClientImpl - Submitted application application_1444143925809_0112
2015-10-07 18:43:20,966 [JobControl] INFO  org.apache.hadoop.mapreduce.Job - The url to track the job: http://babar.es.its.nyu.edu:8088/proxy/application_1444143925809_0112/
2015-10-07 18:43:20,966 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - HadoopJobId: job_1444143925809_0112
2015-10-07 18:43:20,966 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - Processing aliases actual_result,temp1
2015-10-07 18:43:20,966 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - detailed locations: M: actual_result[13,17],temp1[11,9] C: actual_result[13,17],temp1[11,9] R: actual_result[13,17]
2015-10-07 18:43:28,280 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 75% complete
2015-10-07 18:43:36,065 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 100% complete
2015-10-07 18:43:36,085 [main] INFO  org.apache.pig.tools.pigstats.SimplePigStats - Script Statistics: 

HadoopVersion	PigVersion	UserId	StartedAt	FinishedAt	Features
2.6.0-cdh5.4.5	0.12.0-cdh5.4.5	ajr619	2015-10-07 18:42:57	2015-10-07 18:43:36	HASH_JOIN,GROUP_BY

Success!

Job Stats (time in seconds):
JobId	Maps	Reduces	MaxMapTime	MinMapTIme	AvgMapTime	MedianMapTime	MaxReduceTime	MinReduceTime	AvgReduceTime	MedianReducetime	Alias	Feature	Outputs
job_1444143925809_0111	2	1	2	2	2	2	2	2	2	2	Tokens,in,inter_res,patterns	HASH_JOIN	
job_1444143925809_0112	1	1	2	2	2	2	2	2	2	2	actual_result,temp1	GROUP_BY,COMBINER	hdfs://babar.es.its.nyu.edu:8020/tmp/temp184161258/tmp-475187904,

Input(s):
Successfully read 3 records from: "hdfs://babar.es.its.nyu.edu:8020/user/ajr619/input"
Successfully read 4 records from: "hdfs://babar.es.its.nyu.edu:8020/user/ajr619/words"

Output(s):
Successfully stored 4 records (57 bytes) in: "hdfs://babar.es.its.nyu.edu:8020/tmp/temp184161258/tmp-475187904"

Counters:
Total records written : 4
Total bytes written : 57
Spillable Memory Manager spill count : 0
Total bags proactively spilled: 0
Total records proactively spilled: 0

Job DAG:
job_1444143925809_0111	->	job_1444143925809_0112,
job_1444143925809_0112


2015-10-07 18:43:37,087 [main] INFO  org.apache.hadoop.ipc.Client - Retrying connect to server: compute-1-10.local/10.0.255.252:37300. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=3, sleepTime=1000 MILLISECONDS)
2015-10-07 18:43:38,087 [main] INFO  org.apache.hadoop.ipc.Client - Retrying connect to server: compute-1-10.local/10.0.255.252:37300. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=3, sleepTime=1000 MILLISECONDS)
2015-10-07 18:43:39,087 [main] INFO  org.apache.hadoop.ipc.Client - Retrying connect to server: compute-1-10.local/10.0.255.252:37300. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=3, sleepTime=1000 MILLISECONDS)
2015-10-07 18:43:39,190 [main] INFO  org.apache.hadoop.mapred.ClientServiceDelegate - Application state is completed. FinalApplicationStatus=SUCCEEDED. Redirecting to job history server
2015-10-07 18:43:39,383 [main] INFO  org.apache.hadoop.mapred.ClientServiceDelegate - Application state is completed. FinalApplicationStatus=SUCCEEDED. Redirecting to job history server
2015-10-07 18:43:39,450 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - Success!
2015-10-07 18:43:39,451 [main] INFO  org.apache.hadoop.conf.Configuration.deprecation - fs.default.name is deprecated. Instead, use fs.defaultFS
2015-10-07 18:43:39,452 [main] INFO  org.apache.pig.data.SchemaTupleBackend - Key [pig.schematuple] was not set... will not generate code.
2015-10-07 18:43:39,455 [main] INFO  org.apache.hadoop.mapreduce.lib.input.FileInputFormat - Total input paths to process : 1
2015-10-07 18:43:39,455 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths to process : 1
(dec,2)
(java,0)
(chicago,1)
(hackathon,2)
]0;ajr619@login-1-1:~/pig[ajr619@login-1-1 pig]$ exit
exit

Script done on Wed 07 Oct 2015 06:44:04 PM EDT
